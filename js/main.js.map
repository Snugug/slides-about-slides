{"version":3,"file":"main.js","sources":["../../node_modules/stage-fright/src/js/lib/structure.js","../../node_modules/stage-fright/src/js/lib/state/pubsub.js","../../node_modules/stage-fright/src/js/lib/state/store.js","../../node_modules/stage-fright/src/js/lib/state/mutations.js","../../node_modules/stage-fright/src/js/lib/state/actions.js","../../node_modules/stage-fright/src/js/lib/display/translate.js","../../node_modules/stage-fright/src/js/lib/display/fragments.js","../../node_modules/stage-fright/src/js/lib/navigation/hash.js","../../node_modules/stage-fright/src/js/lib/navigation/history.js","../../node_modules/stage-fright/src/js/lib/init.js","../../src/js/main.js"],"sourcesContent":["class StageFrightNode {\n  constructor(item) {\n    this.elem = item;\n    this.previous = null;\n    this.next = null;\n    this.first = false;\n    this.notes = null;\n\n    if (item.classList.contains('_stage--slide')) {\n      this.type = 'slide';\n\n      if (item.parentNode.firstElementChild === item) {\n        this.first = true;\n      }\n    } else if (item.classList.contains('fragment')) {\n      this.type = 'fragment';\n    }\n\n    const notes = item.querySelector('._stage--notes');\n    if (notes) {\n      this.notes = notes.innerHTML;\n    }\n  }\n}\n\nexport class StageFrightList {\n  constructor() {\n    this._head = null;\n    this._tail = null;\n    this._length = 0;\n\n    this._sectionHolder = -1;\n    this._depthHolder = 0;\n    this._fragmentHolder = 0;\n    this._fragmentDepth = [];\n  }\n\n  add(item) {\n    const node = new StageFrightNode(item);\n    let current = this._head;\n\n    if (node.first) {\n      this._sectionHolder++;\n      this._depthHolder = 0;\n    } else if (node.type !== 'fragment') {\n      this._depthHolder++;\n    }\n\n    if (node.type !== 'fragment') {\n      if (this._fragmentHolder !== 0) {\n        this._fragmentDepth.push(this._fragmentHolder);\n        this._fragmentHolder = 0;  \n      }\n    } else {\n      this._fragmentHolder++;\n      node.fragment = this._fragmentHolder;\n    }\n\n    node.section = this._sectionHolder;\n    node.depth = this._depthHolder;\n    node.previous = this._tail;\n    this._length++;\n\n    // If there isn't a head, make head, tail, and current our node! then increase the length;\n    if (!current) {\n      this._head = node;\n      this._tail = node;\n\n      return node;\n    }\n\n    // If there is a current, update the tail\n    this._tail.next = node;\n    this._tail = node;\n\n    if (node.type === 'fragment' && node.previous.type !== 'fragment') {\n      node.previous.fragment = 0;\n    }\n\n    if (node.type === 'fragment' && node.previous.notes) {\n      node.notes = node.previous.notes;\n    }\n\n    return node;\n  }\n\n  find(index) {\n    index = parseInt(index);\n\n    if (index > this._length - 1 || index < 0) {\n      return false;\n    }\n\n    // First\n    if (index === 0) {\n      return this._head;\n    }\n\n    // Last\n    if (index === this._length - 1) {\n      return this._tail;\n    }\n\n    // Start from the end or the beginning?\n    const headToTail = index <= Math.floor(this._length / 2);\n    let current = this._head;\n    let i = 1;\n\n    if (headToTail) {      \n      do {\n        current = current.next;\n        i++;\n      } while (i <= index);\n    }\n    else {\n      current = this._tail;\n      i = this._length - 2;\n\n      do {\n        current = current.previous;\n        i--;\n      } while (i >= index);\n    }\n\n    return current;\n  }\n\n  forEach(cb) {\n    let current = this._head;\n    let i = 0;\n    while (current.next) {\n      cb(current, i);\n      current = current.next;\n      i++;\n    }\n\n    cb(current);\n  }\n\n  updateFragments() {\n    const fragTotals = this._fragmentDepth.reverse();\n    let currentFrag = fragTotals.pop();\n    this.forEach(item => {\n      if (item.hasOwnProperty('fragment')) {\n        item.totalFragments = currentFrag;\n\n        if (item.next.type !== 'fragment') {\n          currentFrag = fragTotals.pop();\n        }\n      }\n    });\n  }\n\n  buildProgress(store, createMinimapLink) {\n    this.forEach((item, i) => {\n      if (item.type === 'slide') {\n        item.progress = createMinimapLink(i, item.section, item.depth, item.hasOwnProperty('fragment'));\n      } else {\n        item.progress = item.previous.progress;\n      }\n    });\n  }\n}\n","export default class PubSub {\n  constructor() {\n    this.events = {};\n  }\n\n  subscribe(event, cb) {\n    if (!this.events[event]) {\n      this.events[event] = [];\n    }\n\n    return this.events[event].push(cb);\n  }\n\n  publish(event, data = {}) {\n    if (!this.events[event]) {\n      return [];\n    }\n\n    return this.events[event].map(cb => cb(data));\n  }\n}\n","import PubSub from './pubsub.js';\n\nexport default class Store {\n  constructor(params = {}) {\n    const self = this;\n\n    this.actions = params.actions || {};\n    this.mutations = params.mutations || {};\n    this.status = 'resting';\n    this.changes = new PubSub();\n    this.stage = params.stage || {};\n    this.progress = params.progress || [];\n    this.root = params.root || document.body;\n\n    this.state = new Proxy((params.state || {}), {\n      set: function(state, key, value) {\n        state[key] = value;\n\n        if(self.status !== 'mutation') {\n          console.warn(`You should use a mutation to set ${key}`);\n        }\n        \n        self.changes.publish(`${key}`, self.state);\n        self.changes.publish('stateChange', self.state);\n\n        return true;\n      }\n    });\n  }\n\n  dispatch(action, payload) {\n    if (typeof this.actions[action] !== 'function') {\n      console.error(`Action \"${action}\" doesn't exist`);\n      return false;\n    }\n\n    this.status = 'action';\n\n    this.actions[action](this, payload);\n\n    return true;\n  }\n\n  async commit(mutation, payload) {\n    if (typeof this.mutations[mutation] !== 'function') {\n      console.error(`Mutation \"${mutation}\" doesn't exist`);\n      return false;\n    }\n\n    this.status = 'mutation';\n\n    let newState = this.mutations[mutation](Object.assign({}, this.state), payload);\n\n    if ('then' in newState) {\n      newState = await newState;\n      this.state = Object.assign(this.state, newState);\n    } else {\n      this.state = Object.assign(this.state, newState);  \n    }\n\n    return true;\n  }\n}\n","export default {\n  navigate(state, payload) {\n    if (payload === 'next' && state.current.next) {\n      state.current = state.current.next;\n      state.index = state.index + 1;\n    } else if (payload === 'previous' && state.current.previous) {\n      state.current = state.current.previous;\n      state.index = state.index - 1;\n    } else if (payload !== 'next' && payload !== 'previous') {\n      state.current = payload;\n    }\n\n    return state;\n  },\n  index(state, payload) {\n    state.index = payload;\n\n    return state;\n  },\n  progress(state, payload) {\n    const previous = state.progress;\n    state.progress = state.current.progress;\n\n    if (state.progress) {\n      if (previous && previous !== state.progress && previous.dataset.hasOwnProperty('active')) {\n        delete previous.dataset.active;\n      }\n\n      state.progress.dataset.active = true;\n\n      if (state.current.hasOwnProperty('fragment')) {\n        if (state.current.fragment === state.current.totalFragments) {\n          state.progress.dataset.fragments = false;\n        } else {\n          state.progress.dataset.fragments = true;\n        }\n      }  \n    }\n    \n    return state;\n  },\n  async notes(state, { root, length }) {\n    if (state.presentation.request) {\n      if (!state.presentation.connection) {\n        try {\n          const connection = await state.presentation.request.start();\n          state.presentation.connection = connection;\n\n          // Need a way to reverse this\n          const { notesBody, updateNotes, advancePresentation } = await import('../presentation');\n          const builtNotes = notesBody();\n          root.parentNode.insertBefore(builtNotes._notes, root);\n          root.dataset.hidden = true;\n          root.parentNode.dataset.notes = true;\n\n          updateNotes(builtNotes, state.index, state.current);\n          builtNotes.total.textContent = length - 1;\n          state.presentation.notes = builtNotes;\n\n        } catch(e) {\n          console.log(e);\n          console.error('There was an error establishing a connection');\n        }  \n      } else {\n        root.parentNode.removeChild(state.presentation.notes._notes);\n        delete root.dataset.hidden;\n        delete root.parentNode.dataset.notes;\n        state.presentation.connection.terminate();\n        state.presentation.connection = null;\n        state.presentation.notes = null;\n      }\n    }\n\n    return state;\n  },\n  display(state, payload) {\n    if (state.display === 'presentation') {\n      state.display = 'article';\n    } else {\n      state.display = 'presentation';\n    }\n\n    return state;\n  }\n}\n","export default {\n  navigate(context, payload) {\n    if (payload === 'next' || payload === 'previous') {\n      context.commit('navigate', payload);  \n    } else {\n      const found = context.stage.find(payload);\n      context.commit('navigate', found);\n      context.commit('index', payload);\n    }\n\n    if (!context.embedded) {\n      context.commit('progress', 'toggle');  \n    }\n  },\n  notes(context, payload) {\n    context.commit('notes', { root: context.root, length: context.stage._length });\n  },\n  display(context, payload) {\n    context.commit('display', payload);\n  }\n}\n","export default function(root, current) {\n  const transform = `translate(${-100 * current.section}vw) translateY(${-100 * current.depth}vh)`;\n  root.style.transform = transform;\n}\n","export default function(current) {\n  let active = false;\n\n  // Make the current fragment active (only will happen on _next_)\n  if (current.type === 'fragment') {\n    const dataset = current.elem.dataset;\n    if (!dataset.hasOwnProperty('active') || dataset.active === 'false') {\n      dataset.active = true;\n\n      let previous = current.previous;\n\n      while (previous && previous.type === 'fragment') {\n        previous.elem.dataset.active = true;\n        previous = previous.previous;\n      }\n      \n      active = true;\n    }  \n  }\n\n  // Make the next fragment inactive if we didn't make the current one active\n  if (active === false && current.next && current.next.type === 'fragment') {\n    delete current.next.elem.dataset.active;\n  }\n}\n","export default function(max) {\n  const starter = new URL(window.location);\n  let pos = 0;\n\n  if (starter.hash) {\n    pos = parseInt(starter.hash.split('/')[1]);\n  }\n\n  if (pos < 0) {\n    pos = 0;\n  } else if (pos > max) {\n    pos = max;\n  }\n\n  return pos;\n}\n","export default function updateHistory(index) {\n  history.pushState(null, null, `#/${index}`);\n}\n","import { StageFrightList } from './structure';\n\nimport Store from './state/store';\nimport mutations from './state/mutations';\nimport actions from './state/actions';\n\nimport translate from './display/translate';\nimport fragments from './display/fragments';\n\nimport navHash from './navigation/hash';\nimport updateHistory from './navigation/history';\n\nimport { createPresentation } from './presentation';\n\nexport default class StageFright {\n  constructor(root, options = {spacebar: true, remote: true}) {\n    const rootNode = document.querySelector(root);\n    // Make the Stage Fright Stage\n    rootNode.parentNode.classList.add('stage-fright');\n\n    const items = Array.from(rootNode.querySelectorAll('._stage--slide, .fragment'));\n\n    // Stage\n    const stage = new StageFrightList();\n    items.forEach(item => {\n      stage.add(item);\n    });\n    stage.updateFragments();\n\n    const embedded = new URLSearchParams(window.location.search).get('embedded') === 'true';\n\n    if (embedded) {\n      rootNode.parentNode.classList.add('embedded');\n    }\n\n    // Presentation Awesomeness\n    let presentation = false;\n\n    // Starting Index\n    const start = navHash(stage.length - 1);\n\n    // Set up state and store\n    this.store = new Store({\n      actions,\n      mutations,\n      progress: 'foo',\n      state: {\n        current: stage._head,\n        progress: null,\n        index: start,\n        notes: false,\n        presentation: createPresentation(),\n        display: 'presentation',\n      },\n      stage,\n      embedded,\n      root: rootNode,\n    });\n\n    this.store.changes.subscribe('current', async (state) => {\n      translate(rootNode, state.current);\n      fragments(state.current);\n      if (state.presentation.notes) {\n        const { updateNotes } = await import('./presentation');\n        updateNotes(state.presentation.notes, state.index, state.current);  \n      }\n    });\n\n    this.store.changes.subscribe('index', async (state) => {\n      updateHistory(state.index);\n\n      if (!embedded) {\n        const { advancePresentation } = await import('./presentation');\n        advancePresentation(state.presentation.connection, state.index);  \n      }\n      \n      if (state.presentation.notes) {\n        const { updateNotes } = await import('./presentation');\n        updateNotes(state.presentation.notes, state.index, state.current);  \n      }\n    });\n\n    this.store.changes.subscribe('display', (state) => {\n      if (state.display === 'presentation') {\n        rootNode.parentNode.classList.add('stage-fright');\n        document.body.scrollTop = document.documentElement.scrollTop = 0;\n      } else {\n        rootNode.parentNode.classList.remove('stage-fright');\n      }\n    });\n\n    this.store.changes.subscribe('presentation', async (state) => {\n      \n      if (state.presentation.connection) {\n        const { advancePresentation } = await import('./presentation');\n        \n        state.presentation.connection.addEventListener('message', e => {\n          const message = JSON.parse(e.data);\n\n          if (message.start) {\n            advancePresentation(state.presentation.connection, state.index);\n          }\n\n          if (message.goto !== state.index) {\n            this.goto(message.goto);  \n          }\n        });\n      }\n    })\n\n    requestIdleCallback(() => {\n      if (!embedded) {\n        import('./upgrade').then(({upgrade}) => {\n          upgrade.bind(this)(stage, rootNode, start, options);\n        });\n      } else {\n        this.goto(start);\n      }\n    }, { timeout: 500 });\n    \n    // Set up progress\n    window.addEventListener('hashchange', () => {\n      const pos = navHash(stage.length - 1);\n      this.goto(pos);\n    });\n    \n    import('./lazyload').then(({default: lazyload}) => lazyload());\n  }\n\n  next() {\n    this.store.dispatch('navigate', 'next');\n  }\n\n  previous() {\n    this.store.dispatch('navigate', 'previous');\n  }\n\n  goto(slide) {\n    this.store.dispatch('navigate', slide);\n  }\n}\n","import StageFright from 'stage-fright';\n\nwindow.addEventListener('DOMContentLoaded', () => {\n  const stage = new StageFright('._stage');\n  window.stage = stage;\n});\n\nwindow.addEventListener('load', async () => {\n  await import('prismjs');\n  await import('prismjs/components/prism-javascript');\n});\n"],"names":["StageFrightNode","constructor","item","elem","previous","next","first","notes","classList","contains","type","parentNode","firstElementChild","querySelector","innerHTML","StageFrightList","_head","_tail","_length","_sectionHolder","_depthHolder","_fragmentHolder","_fragmentDepth","add","node","current","fragment","push","section","depth","find","index","parseInt","headToTail","Math","floor","i","forEach","cb","updateFragments","fragTotals","reverse","currentFrag","pop","hasOwnProperty","totalFragments","buildProgress","store","createMinimapLink","progress","PubSub","events","subscribe","event","publish","data","map","Store","params","self","actions","mutations","status","changes","stage","root","document","body","state","Proxy","set","key","value","console","warn","dispatch","action","payload","error","commit","mutation","newState","Object","assign","navigate","dataset","active","fragments","length","presentation","request","connection","start","notesBody","updateNotes","advancePresentation","builtNotes","insertBefore","_notes","hidden","total","textContent","e","log","removeChild","terminate","display","context","found","embedded","transform","style","max","starter","URL","window","location","pos","hash","split","updateHistory","history","pushState","StageFright","options","spacebar","remote","rootNode","items","Array","from","querySelectorAll","URLSearchParams","search","get","navHash","createPresentation","translate","scrollTop","documentElement","remove","addEventListener","message","JSON","parse","goto","requestIdleCallback","then","upgrade","bind","timeout","default","lazyload","slide"],"mappings":"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"}