{"version":3,"file":"presentation.js","sources":["../../node_modules/stage-fright/src/js/lib/presentation.js"],"sourcesContent":["export function createPresentation() {\n  const request = window.PresentationRequest ? new PresentationRequest([window.location.origin + window.location.pathname]) : null;\n\n  const presentation = {\n    request,\n    connection: null,\n  };\n\n  if (request) {\n    // Make the default presentation request our presentation request\n    navigator.presentation.defaultRequest = presentation.request;\n  }\n\n  return presentation;\n}\n\nexport async function receivePresentationControls(store) {\n  if (navigator.presentation && navigator.presentation.receiver) {\n    const list = await navigator.presentation.receiver.connectionList;\n\n    list.connections.map(connection => addPresentationConnection(connection, store));\n  }\n}\n\nexport function addPresentationConnection(connection, store) {\n  connection.send(JSON.stringify({\n    start: true,\n  }));\n\n  connection.addEventListener('message', e => {\n    const message = JSON.parse(e.data);\n\n    if (message.hasOwnProperty('goto')) {\n      store.dispatch('navigate', message.goto);  \n    }\n  });\n\n  store.changes.subscribe('index', (state) => {\n    connection.send(JSON.stringify({\n      goto: state.index,\n    }));\n  });\n}\n\nexport function advancePresentation(connection, goto) {\n  if (connection) {\n    connection.send(JSON.stringify({\n      goto,\n    }));\n  }\n}\n\nexport function buildNotesPreviewLink(index) {\n  const locale = window.location;\n  const search = new URLSearchParams();\n  const link = new URL(locale.origin + locale.pathname);\n  link.hash = `#/${index}`;\n  search.set('embedded', true);\n\n  link.search = search.toString();\n\n  return link.toString();\n}\n\nexport function updateNotes(notes, index, current) {\n  // Update Notes preview URLs on index change;\n  notes.current.src = buildNotesPreviewLink(index);\n\n  let nextSlideIndex = index + 1;\n\n  if (!current.next) {\n    nextSlideIndex--;\n  }\n\n  notes.next.src = buildNotesPreviewLink(nextSlideIndex);\n\n  if (current.notes) {\n    notes.content.innerHTML = current.notes;\n  } else {\n    notes.content.innerHTML = '';\n  }\n\n  notes.index.textContent = index;\n\n  if (current.hasOwnProperty('fragment')) {\n    notes.fragments.dataset.active = true;\n    notes.currentFrag.textContent = current.fragment;\n    notes.totalFrag.textContent = current.totalFragments;\n  } else {\n    if (notes.fragments.dataset.hasOwnProperty('active')) {\n      delete notes.fragments.dataset.active;\n    }\n    notes.currentFrag.textContent = '';\n    notes.totalFrag.textContent = '';\n  }\n}\n\nexport function timing(parent) {\n  const clock = parent.querySelector('.clock--value');\n  const timer = parent.querySelector('.timer');\n  const hour = parent.querySelector('.timer--hours');\n  const minute = parent.querySelector('.timer--minutes');\n  const second = parent.querySelector('.timer--seconds');\n  let start = new Date();\n\n  // Update to begin\n  update();\n\n  // Update every second\n  let runningClock = setInterval(update, 1000);\n\n  timer.addEventListener('click', e => {\n    start = new Date();\n\n    clearInterval(runningClock);\n\n    hour.textContent = timePad(0);\n    minute.textContent = `:${timePad(0)}`;\n    second.textContent = `:${timePad(0)}`;\n\n    runningClock = setInterval(update, 1000);\n  });\n\n  function update() {\n    const now = new Date();\n\n    const diff = now.getTime() - start.getTime();\n    const hours = Math.floor(diff / (1000 * 60 * 60));\n    const minutes = Math.floor((diff / (1000 * 60)) % 60);\n    const seconds = Math.floor((diff / (1000)) % 60);\n\n    clock.textContent = now.toLocaleTimeString('en-US', {\n      hour12: false,\n      hour: '2-digit',\n      minute: '2-digit',\n    });\n    hour.textContent = timePad(hours);\n    minute.textContent = `:${timePad(minutes)}`;\n    second.textContent = `:${timePad(seconds)}`;\n\n    hour.setAttribute('data-mute', hours <= 0);\n    minute.setAttribute('data-mute', minutes <= 0);\n  }\n\n  function timePad(time) {\n    const str = `00${parseInt(time)}`;\n    return str.substring(str.length - 2);\n  }\n}\n\nexport function notesBody() {\n  const notes = document.createElement('section');\n  notes.classList.add('_speaker-notes');\n\n  notes.innerHTML = '<div class=\"_speaker-notes--current\"> <iframe class=\"_speaker-notes--slide-preview\" frameborder=\"0\" height=\"1024\" width=\"1280\"></iframe> </div><div class=\"_speaker-notes--upcoming\"> <span class=\"_speaker-notes--label\">Upcoming:</span> <iframe class=\"_speaker-notes--slide-preview\" frameborder=\"0\" height=\"1024\" width=\"1280\"></iframe> </div><div class=\"_speaker-notes--controls\"> <div class=\"controls\"> <div class=\"controls--time\"> <h4 class=\"controls--label\">Time <span class=\"controls--reset\">Click to Reset</span></h4> <button class=\"timer\"> <span class=\"timer--hours\">00</span><span class=\"timer--minutes\">:00</span><span class=\"timer--seconds\">:00</span> </button><div class=\"clock\"> <span class=\"clock--value\">0:00 AM</span> </div></div><div class=\"controls--position\"> <p class=\"controls--fragment\">Fragment <span class=\"controls--fragment-current\"></span>/<span class=\"controls--fragment-total\"></span></p><p class=\"controls--slide\">Step <span class=\"controls--slide-current\"></span>/<span class=\"controls--slide-total\"></span></p></div></div></div><article class=\"_speaker-notes--notes\"> <div class=\"slide-notes\"> <h4 class=\"slide-notes--label\">Notes</h4> <div class=\"slide-notes--content\"></div></div></article>';\n\n  timing(notes);\n\n  return {\n    _notes: notes,\n    current: notes.querySelector('._speaker-notes--current ._speaker-notes--slide-preview'),\n    next: notes.querySelector('._speaker-notes--upcoming ._speaker-notes--slide-preview'),\n    content: notes.querySelector('.slide-notes--content'),\n    index: notes.querySelector('.controls--slide-current'),\n    total: notes.querySelector('.controls--slide-total'),\n    fragments: notes.querySelector('.controls--fragment'),\n    currentFrag: notes.querySelector('.controls--fragment-current'),\n    totalFrag: notes.querySelector('.controls--fragment-total'),\n  }\n}\n"],"names":["createPresentation","request","window","PresentationRequest","location","origin","pathname","presentation","connection","navigator","defaultRequest","receivePresentationControls","store","receiver","list","connectionList","connections","map","addPresentationConnection","send","JSON","stringify","start","addEventListener","e","message","parse","data","hasOwnProperty","dispatch","goto","changes","subscribe","state","index","advancePresentation","buildNotesPreviewLink","locale","search","URLSearchParams","link","URL","hash","set","toString","updateNotes","notes","current","src","nextSlideIndex","next","content","innerHTML","textContent","fragments","dataset","active","currentFrag","fragment","totalFrag","totalFragments","timing","parent","update","Math","floor","now","Date","diff","getTime","hours","minutes","seconds","clock","toLocaleTimeString","hour12","hour","minute","timePad","second","setAttribute","time","str","parseInt","substring","length","querySelector","timer","runningClock","setInterval","clearInterval","notesBody","document","createElement","classList","add","_notes","total"],"mappings":"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"}